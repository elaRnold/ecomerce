{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP245-G8\\\\Desktop\\\\React-Ecommerce\\\\src\\\\App.js\";\nimport React, { Component } from \"react\";\nimport { Switch, Route, Link, BrowserRouter as Router } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport ProductList from \"./components/ProductList\";\nimport AddProduct from \"./components/AddProduct\";\nimport Cart from \"./components/Cart\";\nimport data from \"./Data\";\nimport Context from \"./Context\";\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.login = (usn, pwd) => {\n      let user = data.users.find(u => u.username === usn && u.password === pwd);\n\n      if (user) {\n        this.setState({\n          user\n        });\n        localStorage.setItem(\"user\", JSON.stringify(user));\n        return true;\n      }\n\n      return false;\n    };\n\n    this.logout = e => {\n      e.preventDefault();\n      this.setState({\n        user: null\n      });\n      localStorage.removeItem(\"user\");\n    };\n\n    this.addProduct = (product, callback) => {\n      let products = this.state.products.slice();\n      products.push(product);\n      localStorage.setItem(\"products\", JSON.stringify(products));\n      this.setState({\n        products\n      }, () => callback && callback());\n    };\n\n    this.addToCart = cartItem => {\n      let cart = this.state.cart;\n\n      if (cart[cartItem.id]) {\n        cart[cartItem.id].amount += cartItem.amount;\n      } else {\n        cart[cartItem.id] = cartItem;\n      }\n\n      if (cart[cartItem.id].amount > cart[cartItem.id].product.stock) {\n        cart[cartItem.id].amount = cart[cartItem.id].product.stock;\n      }\n\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState({\n        cart\n      });\n    };\n\n    this.checkout = () => {\n      if (!this.state.user) {\n        this.routerRef.current.history.push(\"/login\");\n        return;\n      }\n\n      const cart = this.state.cart;\n      const products = this.state.products.map(p => {\n        if (cart[p.name]) {\n          p.stock = p.stock - cart[p.name].amount;\n        }\n\n        return p;\n      });\n      this.setState({\n        products\n      });\n      this.clearCart();\n    };\n\n    this.removeFromCart = cartItemId => {\n      let cart = this.state.cart;\n      delete cart[cartItemId];\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState({\n        cart\n      });\n    };\n\n    this.clearCart = () => {\n      let cart = {};\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      this.setState({\n        cart\n      });\n    };\n\n    this.state = {\n      user: null,\n      cart: {},\n      products: []\n    };\n    this.routerRef = React.createRef();\n  }\n\n  componentDidMount() {\n    let products = localStorage.getItem(\"products\");\n    let cart = localStorage.getItem(\"cart\");\n    let user = localStorage.getItem(\"user\");\n    products = products ? JSON.parse(products) : data.initProducts;\n    cart = cart ? JSON.parse(cart) : {};\n    user = user ? JSON.parse(user) : null;\n    this.setState({\n      products,\n      user,\n      cart\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: { ...this.state,\n        removeFromCart: this.removeFromCart,\n        addToCart: this.addToCart,\n        login: this.login,\n        addProduct: this.addProduct,\n        clearCart: this.clearCart,\n        checkout: this.checkout\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Router, {\n      ref: this.routerRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"nav\", {\n      className: \"navbar container\",\n      role: \"navigation\",\n      \"aria-label\": \"main navigation\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"navbar-brand\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      className: \"navbar-item is-size-4 \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }\n    }, \"Amazonas\"), /*#__PURE__*/React.createElement(\"a\", {\n      href: \"/\",\n      role: \"button\",\n      className: \"navbar-burger burger\",\n      \"aria-label\": \"menu\",\n      \"aria-expanded\": \"false\",\n      \"data-target\": \"navbarBasicExample\",\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          showMenu: !this.state.showMenu\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 19\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: `navbar-menu ${this.state.showMenu ? \"is-active\" : \"\"}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/products\",\n      className: \"navbar-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }, \"Productos\"), this.state.user && this.state.user.accessLevel < 1 && /*#__PURE__*/React.createElement(Link, {\n      to: \"/add-product\",\n      className: \"navbar-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 19\n      }\n    }, \"A\\xF1adir producto\"), /*#__PURE__*/React.createElement(Link, {\n      to: \"/cart\",\n      className: \"navbar-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }\n    }, \"Carrito\", /*#__PURE__*/React.createElement(\"span\", {\n      className: \"tag is-primary\",\n      style: {\n        marginLeft: \"5px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 19\n      }\n    }, Object.keys(this.state.cart).length)), !this.state.user ? /*#__PURE__*/React.createElement(Link, {\n      to: \"/login\",\n      className: \"navbar-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 19\n      }\n    }, \"Login\") : /*#__PURE__*/React.createElement(\"a\", {\n      href: \"/\",\n      className: \"navbar-item\",\n      onClick: this.logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 19\n      }\n    }, \"Logout\"))), /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      component: ProductList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/login\",\n      component: Login,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/cart\",\n      component: Cart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/add-product\",\n      component: AddProduct,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/products\",\n      component: ProductList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"img\", {\n      src: \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Google_logo_%282010-2013%29.svg/800px-Google_logo_%282010-2013%29.svg.png\",\n      alt: \"product\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/HP245-G8/Desktop/React-Ecommerce/src/App.js"],"names":["React","Component","Switch","Route","Link","BrowserRouter","Router","Login","ProductList","AddProduct","Cart","data","Context","App","constructor","props","login","usn","pwd","user","users","find","u","username","password","setState","localStorage","setItem","JSON","stringify","logout","e","preventDefault","removeItem","addProduct","product","callback","products","state","slice","push","addToCart","cartItem","cart","id","amount","stock","checkout","routerRef","current","history","map","p","name","clearCart","removeFromCart","cartItemId","createRef","componentDidMount","getItem","parse","initProducts","render","showMenu","accessLevel","marginLeft","Object","keys","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Switch, Route, Link, BrowserRouter as Router } from \"react-router-dom\";\r\nimport Login from \"./components/Login\";\r\nimport ProductList from \"./components/ProductList\";\r\nimport AddProduct from \"./components/AddProduct\";\r\nimport Cart from \"./components/Cart\";\r\nimport data from \"./Data\";\r\nimport Context from \"./Context\";\r\n\r\nexport default class App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      user: null,\r\n      cart: {},\r\n      products: []\r\n    };\r\n\r\n    this.routerRef = React.createRef();\r\n  }\r\n  login = (usn, pwd) => {\r\n    let user = data.users.find(u => u.username === usn && u.password === pwd);\r\n    if (user) {\r\n      this.setState({ user });\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  logout = e => {\r\n    e.preventDefault();\r\n    this.setState({ user: null });\r\n    localStorage.removeItem(\"user\");\r\n  };\r\n\r\n  addProduct = (product, callback) => {\r\n    let products = this.state.products.slice();\r\n    products.push(product);\r\n    localStorage.setItem(\"products\", JSON.stringify(products));\r\n    this.setState({ products }, () => callback && callback());\r\n  };\r\n\r\n  addToCart = cartItem => {\r\n    let cart = this.state.cart;\r\n    if (cart[cartItem.id]) {\r\n      cart[cartItem.id].amount += cartItem.amount;\r\n    } else {\r\n      cart[cartItem.id] = cartItem;\r\n    }\r\n    if (cart[cartItem.id].amount > cart[cartItem.id].product.stock) {\r\n      cart[cartItem.id].amount = cart[cartItem.id].product.stock;\r\n    }\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n    this.setState({ cart });\r\n  };\r\n\r\n  checkout = () => {\r\n    if (!this.state.user) {\r\n      this.routerRef.current.history.push(\"/login\");\r\n      return;\r\n    }\r\n    const cart = this.state.cart;\r\n    const products = this.state.products.map(p => {\r\n      if (cart[p.name]) {\r\n        p.stock = p.stock - cart[p.name].amount;\r\n      }\r\n      return p;\r\n    });\r\n    this.setState({ products });\r\n    this.clearCart();\r\n  };\r\n\r\n  removeFromCart = cartItemId => {\r\n    let cart = this.state.cart;\r\n    delete cart[cartItemId];\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n    this.setState({ cart });\r\n  };\r\n\r\n  clearCart = () => {\r\n    let cart = {};\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n    this.setState({ cart });\r\n  };\r\n\r\n  componentDidMount() {\r\n    let products = localStorage.getItem(\"products\");\r\n    let cart = localStorage.getItem(\"cart\");\r\n    let user = localStorage.getItem(\"user\");\r\n    products = products ? JSON.parse(products) : data.initProducts;\r\n    cart = cart ? JSON.parse(cart) : {};\r\n    user = user ? JSON.parse(user) : null;\r\n    this.setState({ products, user, cart });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Context.Provider\r\n        value={{\r\n          ...this.state,\r\n          removeFromCart: this.removeFromCart,\r\n          addToCart: this.addToCart,\r\n          login: this.login,\r\n          addProduct: this.addProduct,\r\n          clearCart: this.clearCart,\r\n          checkout: this.checkout\r\n        }}\r\n      >\r\n        <Router ref={this.routerRef}>\r\n          <div className=\"App\">\r\n            <nav\r\n              className=\"navbar container\"\r\n              role=\"navigation\"\r\n              aria-label=\"main navigation\"\r\n            >\r\n              <div className=\"navbar-brand\">\r\n                <b className=\"navbar-item is-size-4 \">Amazonas</b>\r\n\r\n                <a\r\n                  href=\"/\"\r\n                  role=\"button\"\r\n                  className=\"navbar-burger burger\"\r\n                  aria-label=\"menu\"\r\n                  aria-expanded=\"false\"\r\n                  data-target=\"navbarBasicExample\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    this.setState({ showMenu: !this.state.showMenu });\r\n                  }}\r\n                >\r\n                  <span aria-hidden=\"true\"></span>\r\n                  <span aria-hidden=\"true\"></span>\r\n                  <span aria-hidden=\"true\"></span>\r\n                </a>\r\n              </div>\r\n              <div\r\n                className={`navbar-menu ${\r\n                  this.state.showMenu ? \"is-active\" : \"\"\r\n                }`}\r\n              >\r\n                <Link to=\"/products\" className=\"navbar-item\">\r\n                  Productos\r\n                </Link>\r\n                {this.state.user && this.state.user.accessLevel < 1 && (\r\n                  <Link to=\"/add-product\" className=\"navbar-item\">\r\n                    Añadir producto\r\n                  </Link>\r\n                )}\r\n                <Link to=\"/cart\" className=\"navbar-item\">\r\n                  Carrito\r\n                  <span\r\n                    className=\"tag is-primary\"\r\n                    style={{ marginLeft: \"5px\" }}\r\n                  >\r\n                    {Object.keys(this.state.cart).length}\r\n                  </span>\r\n                </Link>\r\n                {!this.state.user ? (\r\n                  <Link to=\"/login\" className=\"navbar-item\">\r\n                    Login\r\n                  </Link>\r\n                ) : (\r\n                  <a href=\"/\" className=\"navbar-item\" onClick={this.logout}>\r\n                    Logout\r\n                  </a>\r\n                )}\r\n              </div>\r\n            </nav>\r\n\r\n            <Switch>\r\n              <Route exact path=\"/\" component={ProductList} />\r\n              <Route exact path=\"/login\" component={Login} />\r\n              <Route exact path=\"/cart\" component={Cart} />\r\n              <Route exact path=\"/add-product\" component={AddProduct} />\r\n              <Route exact path=\"/products\" component={ProductList} />\r\n            </Switch>\r\n          </div>\r\n        </Router>\r\n        <img\r\n                src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Google_logo_%282010-2013%29.svg/800px-Google_logo_%282010-2013%29.svg.png\"\r\n                alt=\"product\"\r\n              />\r\n      </Context.Provider>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}